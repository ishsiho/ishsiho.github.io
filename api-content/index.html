{"posts":[{"title":"记录docker搭建YouTube订阅同步podsync容器遇到的一些坑","content":"🪧🪧✉️✉️You can touch me with Telegram:@Hsi Ho. podsync容器 GitHub项目地址：https://github.com/mxpv/podsync podsync 容器，简单来说就是一个集成了youtube-dl的podcast服务容器，可以把YouTube的频道或者列表视频，按照预定好的时间频率不断刷新然后下载下来，然后生成泛播客订阅。 如上图，即是podsync生成的苏通河牛通YouTube channel的rss订阅文件，其中红框框起来的item，就是一期视频。整个rss文件包括了频道信息，youtuber的简介信息，每一期视频标题跟简介。而且已经将每一期的视频下载到了服务器的本地上，因此只需要服务器可以连接到YouTube网站，其他设备连接到这台服务器则不需要要求网络“畅通”。 当然，这个容器还是可以完成一些其他的需求，比如没有开通YouTube premium，想要后台播放功能，这个也算是一种曲线救国。 我自己的初衷 我自己最开始是为了解决因为Apple TV缺少国区app store，没有优爱腾，尤其是B站，想着是不是可以找到一个工具直接将B站关注的up主的更新的视频下载到群晖NAS上，然后使用PLEX等媒体库软件直接播放。在搜索工具下就找到了podsync这个镜像。虽然没有解决B站的问题，但是倒算是解决了Apple TV网络翻墙不便，不好使用YouTube看视频的问题。 还有一个，也算是可以做到了无感的收集以及批量下载YouTube的视频，省去了自己使用youtube-dl工具一个一个下载YouTube视频。 podsync 容器安装 这个网上有个挺好的教程，可以参考知乎上这篇：利用EMBY，在NAS上打造个人Youtube流媒体中心 。不过需要注意一点，Emby的podcast插件使用需要会员订阅，并不免费；而Emby的平替Jellyfin，插件库里没有podcast插件(目前2021/05/30 为止是这样)。而Plex，移除了插件功能，自身提供的podcast服务不支持泛播客url的订阅。 倒是苹果自家的Podcast app，非常好的支持泛播客，与podsync搭配完美，国内开发者的moonFM播客app，虽然同样支持泛播客订阅，但美中不足，目前为止还无法做到视频播放，只能“听个响”。 一些可能会踩到的坑 虽然上面提到的 利用EMBY，在NAS上打造个人Youtube流媒体中心 已经挺完善了，但是还是留下了一个很严重的坑。 默认的配置，以及 利用EMBY，在NAS上打造个人Youtube流媒体中心 里都没有设置 bind_address 的值，所以在后面由podsync生成的xml文件中，指向视频的链接都会是默认的 http://localhost:port/xx/xxxxx.mp4 ，在其他设备上基本是不可能播放的。还有默认的配置不会生成opml文件，如果在配置文件里关注了很多channel，想要在其他设备的app中导入这些订阅就太麻烦了。 视频链接 localhost 问题 解决 http://localhost:port/xx/xxxxx.mp4 问题时，试过修改 bind_address = http://nasIP:port ，遇到了podsync容器停止运行的问题，大概是我太菜了，去开发者的 GitHub issues 搜索了一下，解决方案也很简单，注释掉 bind_address 这一行，另外添加 hostname = &quot;http://nasIP:port&quot; 。如下图： 解决 podcast 封面模糊 生成的xml 会有两处图片，一个是订阅封面，一个是每集视频的预览封面。每集的预览封面还好，如果是默认设置下，订阅封面还是很模糊的。podsync也给出了自定义设置，可以修改订阅封面图片为自定义图片，设置图片显示质量。例如： [feeds.eSir] # eSir 为最终生成的RSS文件夹的名称，可以修改,不可为中文 url = &quot;https://www.youtube.com/channel/UCOhkliOps3IS48ly-MgPC2A&quot; # 引号内填写Youtube频道/组织/用户/播放列表的链接，比如此处我填写的观视频地址 page_size = 15 # 每次更新多少个视频 (请记住这可能会耗尽API令牌，好像是每天一万个) update_period = &quot;15m&quot; # 更新的频率，例如: &quot;60m&quot;, &quot;4h&quot;, &quot;2h45m&quot;，会按照频率定期更新新的视频 quality = &quot;high&quot; # 或者 &quot;low&quot;，此处为清晰度选择 format = &quot;video&quot; # 或者 &quot;audio&quot;，如果选择audio将只下载音频 opml = true # 是否在生成的opml文件中包含该订阅，默认不设置时为false clean = { keep_last = 150 } # 保留最近的多少个视频/音频文件 custom = { cover_art = &quot;https://a.b.com/img/youtube/eSir.jpg&quot;, cover_art_quality = &quot;high&quot; } # 自定义设置项，cover_art 为自定义订阅封面图片，cover_art_quality 为封面图片显示质量，值为 &quot;high&quot; 或 &quot;low&quot; 。 没有生成opml订阅文件 默认的配置文件订阅设置并不会生成rss订阅的 opml 文件，想要把一堆订阅添加到 podcast app 异常麻烦，参考上面的代码，在订阅设置里添加 opml = true 即可在生成的 opml 文件里包含该feed订阅。 其他设置 参考开发者 GitHub 的文档： custom.cover_art_quality use &quot;high&quot; or &quot;low&quot; to special cover image quality from channel cover default is equal with &quot;quality&quot; and disable when custom.cover_art was set. custom = { title = &quot;Level1News&quot;, description = &quot;News sections of Level1Techs, in a podcast feed!&quot;, author = &quot;Level1Tech&quot;, cover_art = &quot;{IMAGE_URL}&quot;, cover_art_quality = &quot;high&quot;, category = &quot;TV&quot;, subcategories = [&quot;Documentary&quot;, &quot;Tech News&quot;], explicit = true, lang = &quot;en&quot; } # Optional feed customizations max_height = 720 # Optional maximal height of video, example: 720, 1080, 1440, 2160, ... cron_schedule = &quot;@every 12h&quot; # Optional cron expression format. If set then overwrite 'update_period'. See details below filters = { title = &quot;regex for title here&quot;, not_title = &quot;regex for negative title match&quot;, description = &quot;...&quot;, not_description = &quot;...&quot; } # Optional Golang regexp format. If set, then only download matching episodes. opml = true|false # Optional inclusion of the feed in the OPML file (default value: false) clean = { keep_last = 10 } # Keep last 10 episodes (order desc by PubDate) youtube_dl_args = [ &quot;--write-sub&quot;, &quot;--embed-subs&quot;, &quot;--sub-lang&quot;, &quot;en,en-US,en-GB&quot; ] # Optional extra arguments passed to youtube-dl when downloading videos from this feed. This example would embed available English closed captions in the videos. Note that setting '--audio-format' for audio format feeds, or '--format' or '--output' for any format may cause unexpected behaviour. You should only use this if you know what you are doing, and have read up on youtube-dl's options! 还没有解决的一些问题 在 NAS docker中安装这个容器，配置倒是蛮好设置的，但是网络就烦了些，需要让整个 NAS 科学上网。貌似podsync没法在配置文件里单独设置代理。 其次，podsync容器里默认安装了youtube-dl，youtube-dl的下载参数配置不是该怎么去设置，可以使下载的文件名为YouTube的 视频标题-YouTuber-xxxxxxx.mp4 这种格式。并且生成的xml文件里的视频/音频链接也同样修改过来。 不知道YouTube是否有random的视频list或者suggest的list。 还是想要一个类似的工具可以下载国内视频平台的视频。 You can touch me with Telegram:@Hsi Ho. ","link":"https://ishsiho.github.io/post/YouTube-podsync/"},{"title":"docker 安装 CouchDB 用来同步 Moon FM","content":"🪧🪧✉️✉️You can touch me with Telegram:@Hsi Ho. 缘起 说一下缘由，一直都特别喜欢听广播电台节目，觉得充满随机跟不确定性，而且更让人专注于主播的内容。很早前 podcast 就在国外蛮热火，但是在国内却“平平淡淡”，水土不服。第一个接触的 podcast 客户端应该是苹果的 iTunes ，那会 Windows 平台上，苹果还在支持 safari 浏览器。后来陆陆续续还用了微软家的 zune 软件。 这两年，随着 vlog 的火热， 以声音为主的 podcast 也复兴了起来。这一两年里，随着 spotify 支持了 podcast ，国内的各种软件也雨后春笋一般冒起头，比如小宇宙。QQ音乐，网易云音乐的客户端也陆续都加入了播客的功能。不过记得微博上曾经有几个播客节目因为火了，很快被下架，传播只能通过别人的网盘。当时心里觉得，要在红红火火的 podcast 单词上加上一个 之狼里的&quot;危&quot;字。 spotify 添加了 podcast 功能 国内的小宇宙最早靠邀请码传播 最近几天用 docker 安装了 podsync ，可以将 YouTube 上的频道，列表里的视频下载自动下来，并且按频率定时刷新，然后生成 rss 订阅。rsshub 不能直接把 YouTube 视频变为 rss 订阅，这个工具曲线救国变相实现了。最初这个想法是为了在不太容易进行代理的 Apple TV 上看国内各网络平台视频的， 嗐，可惜还没有实现把 B站up主视频自动更新下载下来。 今年 Apple TV 推新的时候，各种传闻国行版已经在审核在路上，心里很激动，说不定，真的能直接在 Apple TV 上看各种国内视频平台了。 正题 扯这么多，下面是正题，前面的 podsync 很好，但就是可惜，生成的 rss 泛播客，大部分的app并不支持。国内开发者开发的这一款 要颜值有颜值，要功能也有功能，并且支持全平台的 moon FM ，真的很不错。遗憾的可能就是基于隐私，开发者并没有为这个app添加账号机制，自身也不支持同步设置，只能自己手动添加订阅，或者选择从 opml 文件导入。想要同步，也只能自己连接 couchdb 数据库。还有一点缺憾，这个app不支持视频播客的视频播放，只能播放音频。 也是闲的才折腾，就记录一下自己在群晖上用 docker 部署安装 couchdb 的“简单过程”。大概是这个数据库还是“小众”了些，网上有关的教程挺少的。 下面是两种方法，终端命令行方式与DSM图形界面安装，喜欢哪种方式用哪一种，步骤里默认你已经开启了ssh端口，并知道怎样ssh连接到群晖。 1、 最简单的部署安装，大概一行命令就好了 docker run -d --name couchdb -p 5984:5984 -v &lt;your path&gt;:/opt/couchdb/data -e COUCHDB_USER=admin -e COUCHDB_PASSWORD=password couchdb 如果要建一个用来同步 moon FM 的数据表，还需要用下面这两行命令： docker exec -it couchdb bash curl -u admin:password -X PUT &lt;群晖IP&gt;:5984/moonfm 最后只要在 moon FM 软件的同步设置里 输入：http://admin:password@群晖IP:5984/moonfm 就可以同步了，这里的“/moonfm”就是上面在couchdb数据库中创建的表。 2、群晖通过图形界面部署安装 2.1 下载镜像 打开群晖的docker套件，点左侧的“注册表”，搜索关键词“couchdb”。 选择第一个镜像双击下载，等待下载完成。 2.2 部署安装 couchdb 选择“映像”，双击刚下载完成的 couchdb 注册表创建容器。 端口映射这里，可以只固定容器内部&quot;5894&quot;这个端口，只修改左侧端口号！ 最后在环境里添加两项，分别是数据库的用户名跟密码：COUCHDB_USER=admin COUCHDB_PASSWORD=password 最后确定，然后运行容器。 2.3 创建一个名为“moonfm”的database用来做moon FM同步 打开容器couchdb的详情，然后选择终端机，新增通过命令启动，输入 bash ，确定。 接着在新打开的bash里输入：curl -u admin:password -X PUT localhost:5984/moonfm 回车 最后同样只要在 moon FM 软件的同步设置里 输入：http://admin:password@群晖IP:5984/moonfm 就可以在多个设备上同步所有订阅了。 是不是还挺简单的，也没有什么坑，但是网上相关教程太少了，只有外网零星才有一些相关结果，怎么去创建database。 最后还是希望 moon FM 的开发者可以增加一些其他的，例如网盘，webDAV等方式来同步不同设备间的订阅；其次，能够像苹果的 podcast 一样，不光支持泛播客订阅，还可以播放视频。 You can touch me with Telegram:@mu2er. ","link":"https://ishsiho.github.io/post/dockerruncouchdb/"},{"title":"这是第一篇文章","content":"主要内容 Markdown是什么？ 谁创造了它？ 为什么要使用它？ 怎么使用？ 谁在用？ 尝试一下 正文 1. Markdown是什么？ Markdown是一种轻量级标记语言，它以纯文本形式(易读、易写、易更改)编写文档，并最终以HTML格式发布。 Markdown也可以理解为将以MARKDOWN语法编写的语言转换成HTML内容的工具。 2. 谁创造了它？ 它由Aaron Swartz和John Gruber共同设计，Aaron Swartz就是那位于去年（2013年1月11日）自杀,有着开挂一般人生经历的程序员。维基百科对他的介绍是：软件工程师、作家、政治组织者、互联网活动家、维基百科人。 他有着足以让你跪拜的人生经历： 14岁参与RSS 1.0规格标准的制订。 2004年入读斯坦福，之后退学。 2005年创建Infogami，之后与Reddit合并成为其合伙人。 2010年创立求进会（Demand Progress），积极参与禁止网络盗版法案（SOPA）活动，最终该提案被撤回。 2011年7月19日，因被控从MIT和JSTOR下载480万篇学术论文并以免费形式上传于网络被捕。 2013年1月自杀身亡。 天才都有早逝的归途。 3. 为什么要使用它？ 它是易读（看起来舒服）、易写（语法简单）、易更改纯文本。处处体现着极简主义的影子。 兼容HTML，可以转换为HTML格式发布。 跨平台使用。 越来越多的网站支持Markdown。 更方便清晰地组织你的电子邮件。（Markdown-here, Airmail） 摆脱Word（我不是认真的）。 4. 怎么使用？ 如果不算扩展，Markdown的语法绝对简单到让你爱不释手。 Markdown语法主要分为如下几大部分： 标题，段落，区块引用，代码区块，强调，列表，分割线，链接，图片，反斜杠 \\，符号'`'。 4.1 标题 两种形式： 1）使用=和-标记一级和二级标题。 一级标题 ========= 二级标题 --------- 效果： 一级标题 二级标题 2）使用#，可表示1-6级标题。 # 一级标题 ## 二级标题 ### 三级标题 #### 四级标题 ##### 五级标题 ###### 六级标题 效果： 一级标题 二级标题 三级标题 四级标题 五级标题 六级标题 4.2 段落 段落的前后要有空行，所谓的空行是指没有文字内容。若想在段内强制换行的方式是使用两个以上空格加上回车（引用中换行省略回车）。 4.3 区块引用 在段落的每行或者只在第一行使用符号&gt;,还可使用多个嵌套引用，如： &gt; 区块引用 &gt;&gt; 嵌套引用 效果： 区块引用 嵌套引用 4.4 代码区块 代码区块的建立是在每行加上4个空格或者一个制表符（如同写代码一样）。如 普通段落： void main() { printf(&quot;Hello, Markdown.&quot;); } 代码区块： void main() { printf(&quot;Hello, Markdown.&quot;); } 注意:需要和普通段落之间存在空行。 4.5 强调 在强调内容两侧分别加上*或者_，如： *斜体*，_斜体_ **粗体**，__粗体__ 效果： 斜体，斜体 粗体，粗体 4.6 列表 使用·、+、或-标记无序列表，如： -（+*） 第一项 -（+*） 第二项 - （+*）第三项 注意：标记后面最少有一个_空格_或_制表符_。若不在引用区块中，必须和前方段落之间存在空行。 效果： 第一项 第二项 第三项 有序列表的标记方式是将上述的符号换成数字,并辅以.，如： 1 . 第一项 2 . 第二项 3 . 第三项 效果： 第一项 第二项 第三项 4.7 分割线 分割线最常使用就是三个或以上*，还可以使用-和_。 4.8 链接 链接可以由两种形式生成：行内式和参考式。 行内式： [younghz的Markdown库](https:😕/github.com/younghz/Markdown &quot;Markdown&quot;)。 效果： younghz的Markdown库。 参考式： [younghz的Markdown库1][1] [younghz的Markdown库2][2] [1]:https:😕/github.com/younghz/Markdown &quot;Markdown&quot; [2]:https:😕/github.com/younghz/Markdown &quot;Markdown&quot; 效果： younghz的Markdown库1 younghz的Markdown库2 注意：上述的[1]:https:://github.com/younghz/Markdown &quot;Markdown&quot;不出现在区块中。 4.9 图片 添加图片的形式和链接相似，只需在链接的基础上前方加一个！。 4.10 反斜杠\\ 相当于反转义作用。使符号成为普通符号。 4.11 符号'`' 起到标记作用。如： `ctrl+a` 效果： ctrl+a 5. 谁在用？ Markdown的使用者： GitHub 简书 Stack Overflow Apollo Moodle Reddit 等等 6. 尝试一下 Chrome下的插件诸如stackedit与markdown-here等非常方便，也不用担心平台受限。 在线的dillinger.io评价也不错 Windowns下的MarkdownPad也用过，不过免费版的体验不是很好。 Mac下的Mou是国人贡献的，口碑很好。 Linux下的ReText不错。 当然，最终境界永远都是笔下是语法，心中格式化 😃。 注意：不同的Markdown解释器或工具对相应语法（扩展语法）的解释效果不尽相同，具体可参见工具的使用说明。 虽然有人想出面搞一个所谓的标准化的Markdown，[没想到还惹怒了健在的创始人John Gruber] (http://blog.codinghorror.com/standard-markdown-is-now-common-markdown/ )。 以上基本是所有traditonal markdown的语法。 其它： 列表的使用(非traditonal markdown)： 用|表示表格纵向边界，表头和表内容用-隔开，并可用:进行对齐设置，两边都有:则表示居中，若不加:则默认左对齐。 代码库 链接 MarkDown https://github.com/younghz/Markdown MarkDownCopy https://github.com/younghz/Markdown 关于其它扩展语法可参见具体工具的使用说明。 ","link":"https://ishsiho.github.io/post/first/"}]}